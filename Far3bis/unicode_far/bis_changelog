За основу взята актуальная версия Far 3.0
Некоторые изменения bis попали в trunk Far 3.0

===

Теперь в bis сборке поле VersionInfo.Revision == 1

From Max Rusov
#1914: Расширение PluginsControl - получение информации о плагинах
FPF_FAR2 тоже работает.

2408bis.1 ============

В 2406 поломали MCTL_ADDMACRO: перестал работать "farmacro" в MacroLib.

2408bis ============

Для 64битной версии фара файл базы кеша плагинов назван plugincache64.db
Для чего - возможность держать в одной папке x86 и x64 версии фара.

2400bis ============

Падение по F4 в F11/AltShiftF9 если все строки - в фильтре.

2392bis ============

#1903: Вызов плагина из макроса
Plugin.Call(Guid[,MenuGuid]) = F11
Plugin.Config(Guid[,MenuGuid]) = F9->Параметры плагинов...
Plugin.Prefix(Guid,Command) = ввод через префикс в комстроке
Plugin.Int(Guid,Item) = алиас callplugin

При загрузке из кеша (ключ /co) загружаются плагины только из "%FARHOME%\Plugins"

При загрузке плагинов отображается информация об ошибках:
* при загрузке из кеша (ключ /co) только о несоответствии бинарника (то есть кеш нужно пересоздать);
* при ручной загрузке, например через "load:!.!", все остальное (дублирование GUID, неподдерживаемый формат, и т.п.)

2317bis ============

#1953: Не вызывать "cmd.exe /c ..." при запуске консольного приложения с аргументами.

2305bis ============

CtrlA показывает владельца и для плагиновых панелей (если плагин отдает владельца).

Измения работы ключа "/co". Загружаются только плагины с расширением ".dll" и только из "%FARHOME%\Plugins".

2269bis ============

#1923: Исправлено падение при Del/F4/... на отфильтрованном (пустом) списке CtrlI в панелях.

#1921: Значительно уменьшено невменяемое время перерисовки _очень_ длинных строк.

2250bis ============

from Denis: патч для закрытия ненужных хэндлов по Ctrl-Break

2249bis ============

#1918: Фар валится при выборе "Standard association"

2248bis ============

#1917: Far валится при вызове CurPos для DI_LISTBOX

2231bis ============

plugin.call не работал, если плагин не был загружен в память.

2223bis2 ============

from 2useven10
#1905: viewer dump mode
 + ShiftF4 - выбор из режима из списка
 + 0x40 в Viewer.State - дамп режим

2223bis ============

Применены патчи от 2useven10 #1773, #1775.
Патчи несколько не совпадают с текущим trunk, что-то может быть не то...

2222bis ============

1. #1903: Plugin.Call(guid,menuGuid)

! Plugin.Menu переименован в Plugin.Call, добавлен Plugin.Config

plugin.call(guid,menuGuid)
  может быть вызвана только из тех макрообластей, которые "умеет" плагин
  ускоренный аналог выбора пункта меню из F11
  гуиды берем из F11 F3
    guid - поле 'Plugin GUID'
    menuGuid - поле 'Plugin item GUID'
  плагин и пункт с такими гуидами должны существовать, иначе функция вернет ошибку
Пример - в редакторе вызвать 'Colorer outliner'
  plugin.Call("D2F36B62-A470-418D-83A3-ED7A3710E5B5","45453CAC-499D-4B37-82B8-0A77F7BD087C") 5

plugin.config(guid[,menuGuid])
  может быть вызвана только из панелей
  ускоренный аналог выбора пункта меню из AltShiftF9
  гуиды берем из «Plugins configuration» F3
    guid - поле 'Plugin GUID'
    menuGuid - поле 'Plugin item GUID', поле необязательное, если не указано
               то функция ConfigureW плагина будет вызвана с GUID_NULL, иначе
               проверяется наличие пункта с таким гуидом.

2. "[?] Show white space" отключает отображение "концов строк" оставляя "пробельные символы".
   API:   EOPT_SHOWLINEBREAK, ESPT_SHOWWHITESPACE(2).
   Macro: editor.set(20,1) - концы строк и пробелы, editor.set(20,2) - только пробелы.

3. from 2useven10
#1905: viewer dump mode

4. from 2useven10
#1773: Дадим возможность разрешать пункт AutoDetect в меню по Shift-F8

2217bis ============

#1903: Plugin.Menu(guid,menuGuid)
  * надоело макросить вызов плагинов через F11.
  * предлагаемая функция - аналогична обычному вызову пункта меню плагина, но в обход
    открытия всего списка и позиционирования куда надо или выбора хоткея
  * в отличие от callplugin - выполнение макроса не останавливается, как и при F11
  * позвать плагин откуда он не ожидает - не получится, проверки области такие же,
    как при населении списка F11

  пример - вызвать colorer outliner (версия под Far3):

  plugin.Menu("D2F36B62-A470-418D-83A3-ED7A3710E5B5","45453CAC-499D-4B37-82B8-0A77F7BD087C") 5 

2216bis ============

From 2useven10
#1766: убираем артефакты при попадании найденного текста в переносимую часть строки при WWrap. Более точно определяем границу переноса (раньше переносилось 'с запасом'). 

2214bis ============

#1832: В диалоги перестали приходить нажатия русских (и т.п.) букв.

2212bis ============

From 2useven10
#1901: Текущая позиция не сохраняется при переключении между View/Edit по F6 на неоднобайтных кодировках

2210bis ============

Информации о плагине: F3 из F11 или AltShiftF9.

2208bis ============

В информации о плагине (F4 из F11 или AltShiftF9) не отображался префикс плагинов PPIF_PRELOAD.

====================

#1898: Глюки отрисовки редактора после выполнения макросов.

====================

#1894: В меню плагинов (F11) и меню конфигурации плагинов (AltShiftF9) строки могли двоиться.

====================

Собран с поддержкой ProcessMacroW и ProcessConsoleInputW.

====================

Исправлены ошибки установки конца строк при переводе каретки и удалении строк.

====================

Продолжение виртуальной свертки строк.

При "[x] Show white space" отображаются концы строк.

====================

На некоторых машинах не работали комбинации типа Ctrl[

====================

Поддержка виртуальной свертки строк в редакторе:
http://forum.farmanager.com/viewtopic.php?f=7&t=6587

====================

From 2useven10
В некоторых случаях вьювер не реагировал на изменения файла.

====================

Начато внедрение код Far'а поддержки RCtrl/RAlt.

Mantis#1833: Поиск файлов - не ThreadSafe

Цвет текста в статусной строке.

Режимы панелей: изменено выравнивание имен по правому краю "NR".
-- пока что мне не нравится как оно получилось, нужно все-таки будет новый модификатор.

====================

Viewer: настройка "Autorefresh on removable drives".

Macro: В некоторых случаях при смене фрейма в {0x0} отрисовывались артефакты.
Например при переходе из панелей в редактор макросом уже в редакторе в {0x0}
мог отрисоваться уголок от панелей.

Оптимизация отображения колонки C0. В настройке режима панели добавлен флажок
"Preload C0 data for all files", который по умолчанию отключен.

В статусных строках расширены возможности для типа 'B[C,R]'
  (только для строки статуса) фиктивная колонка, соответствующая разрыву строки, таким образом
  можно настроить многострочную область статуса; ширина фиктивной колонки (хотя бы и 0) должна
  быть указана
  Можно указать один из модификаторов выравнивания,
  где: C - по центру, лидирующие и концевые пробелы обрезаются;
       R - по правому краю;
  Колонку можно указать на первом месте для выравнивания первой статусной строки

Mantis#1810: Запрос elevation в Info-панели игнорирует настройку "[ ] Show CD drive parameters".

====================
В диалоге назначения плагину горячей клавиши отображается дополнительная
информация: Название, Описание, Автор, GUID плагина, GUID пункта, Префикс.

====================
Mantis#1791: "Cannot find the file" по F5 после Ctrl+Tab из сохранённого в редакторе файла

====================
Если при увеличении строки фильтра выделенная строка оказывается скрытой прыгаем
на первую видимую строку рядом с предыдущей (сверху или снизу - зависит от предыдущего
положения выделенной строки - в верхней или нижней части списка).

В фильтрации не участвует текст разделителей.
Если группа оказывается скрытой - разделитель перед ней тоже скрывается.

Автоматическое увеличение высоты списка при увеличении количества видимых строк
(сброс фильтра или уменьшение строки фильтра).

====================
Mantis#1789: Функция для управления быстрым фильтром в списках (CtrlAltF)
  N=Menu.Filter([Action[,Mode])
    Если мы не в списке - возвращает -1,
    если код возврата специально не оговорен, в случае успеха возвращает 1, в случае ошибки 0.
  Action
    0 - фильтр
      Mode
        -1 - (по умолчанию) вернуть 1 если фильтр уже включен, 0 - фильтр выключен
         1 - включить фильтр, если фильтр уже включен - ничего не делает
         0 - выключить фильтр
    1 - фиксация текста фильтра
      Mode
        -1 - (по умолчанию) вернуть 1 если текст фильтра зафиксирован, 0 - фильтр можно менять с клавиатуры
         1 - зафиксировать фильтр
         0 - отменить фиксацию фильтра
    2 - вернуть 1 если фильтр включен и строка фильтра не пуста
    3 - вернуть количество отфильтрованных (невидимых) строк\
    4 - (по умолчанию) подправить высоту списка под количество элементов

  S=Menu.FilterStr([Action[,S])
    В случае ошибки возвращает пустую строку
  Action
    0 - (по умолчанию) вернуть текущую строку, если фильтр включен
    1 - установить (заменить) в фильтре строку S.
        Если фильтр не был включен - включает его, режим фиксации не трогается, но игнорируется.
        Возвращает предыдущее значение строки фильтра.

====================
Опять работает Anamorphosis

====================
Mantis#0001589: Отображать в колонке панели расширение файла
В настройке колонок можно использовать тип "X" - расширение без точки.
Для папок расширение не отображается, только для файлов.
Если данные колонки X не помещаются - справа отображается знак '}'.
В колонке N можно использовать модификатор N - имя файла без расширения.

====================
Mantis#0001492: Многострочная статусная область в панелях
В настройке типов для статусной строки можно использовать фиктивный
тип "B" (разрыв строки). Хотя он и фиктивный, но ширину для него,
хотя и фиктивную :) указывать все-равно надо.
К типу "B" можно прилепить модификатор выравнивания:
"BC" - по центру, "BR" - по правому краю, просто "B" - по левому краю.
Тип "B" может идти первым, для выравнивания первой статусной строки.

При уменьшении высоты панелей количество отобржаемых статусных строк
при необходимости уменьшается.

В макросах доступны APanel.StatusHeight и PPanel.StatusHeight

====================
Оптимизация загрузки данных в колонку C0
В настройке режимов панелей добавлен флажок "[ ] Preload C0 data for all files"
Если он выключен - данные загружаются только для видимых на панели файлов

==================== From Samlyukov
Изменения в меню Plugins configuration

Del
Выгрузить плагин из памяти или кеша. Действие аналогично макрофункции
Plugin.Unload(DllPath) или команде unload:DllPath
Перед операцией будет показано предупреждение-вопрос. Для плагинов,
у которых выставлен флаг PF_PRELOAD (всегда загружен) показывается
дополнительное подтверждение.
Повторно загрузить плагин можно через Ctrl-R (см. ниже)

Alt-Del
Удалить (деинсталлировать) плагин в системную Корзину.
Перед операцией будет показано предупреждение-вопрос.

Ctrl-R
Перечитать меню.
Будут перечитаны все папки с плагинами, при этом без перезагрузки Far добавятся новые модули и удалятся из внутренних структур отсутствующие с запуска Far плагины.

Ctrl-PgUp/CtrlShift-PgUp
Переход в папку плагина.

Ctrl-Home/CtrlShift-Home
Переход в папку "%FarHome%\Plugins".

Ctrl-1
Включить либо отключить отображение для каждого модуля имя dll-файла и его версии.

Символом  в правой стороне меню отображаются плагины имеющие дополнительные настройки.

Символы колонки статуса имеют следующие значения:
|-| - модуль находится в кеше Far и готов к загрузке.
|+| - модуль всегда загружен (плагин имеет флаг PF_PRELOAD).
|*| - модуль загружен в память Far.
Теоретически, может отобразиться еще один статус:
|%| - плагин имеет флаг PF_PRELOAD, находится в кеше и готов к загрузке.
